import sqlite3
from employee import Employee

DB_NAME="employee.db"

def connect_db():
    conn=sqlite3.connect(DB_NAME)
    return conn

def create_table():
    conn=connect_db()
    cursor= conn.cursor()
    cursor.execute('''
        CREATE TABLE IF NOT EXISTS employees(
        emp_id INTEGER PRIMARY KEY,
        name TEXT NOT NULL,
        department TEXT NOT NULL,
        salary REAL NOT NULL
        )
        ''')
    conn.commit()
    conn.close
def insert_employee(emp: Employee):
    conn= connect_db()
    cursor= conn.cursor()
    cursor.execute('insert into employees(emp_id,name,department,salary) values(?,?,?,?)',
    (emp.emp_id,emp.name,emp.department,emp.salary))
    conn.commit()
    conn.close()
    
def load_employees(emp: Employee):
    conn= connect_db()
    cursor= conn.cursor()
    cursor.execute('select * from employee')
    rows=cursor.fetchall()
    conn.close()
    return [Employee(*row) for row in rows]




---------

from db import (create_table,insert_employee,load_employees)
from employee import Employee

def display_menu():
    print("\n-----Employee CRUD Menu----")
    print("1----Add Employee----")
    print("2----Load Employee----")
    print("6----Exit----")

def main():
    create_table()

    while True:
        display_menu()
        choice= input("Enter Choice to Perform Operations:  ")
        if choice =='1':
            emp_id=int(input('Enter Employee ID: '))
            name= input('Enter Employee Name:  ')
            dept= input('Enter Department Name:  ')
            salary= float(input('Enter Employee Salary:  '))
            emp= Employee(emp_id,name,dept,salary)
            insert_employee(emp)
            print('Employee Added')

        elif choice=='6':
            print('Exiting the app')
            break
        else:
            print('wrong choice')


if __name__ == '__main__':
    main()
